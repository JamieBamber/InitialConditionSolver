#PBS -N JOBNAME
#PBS -l walltime=12:00:00

#PBS -l nodes=10:ppn=36

#PBS -A dp092
#PBS -o job.out
#PBS -e job.err
#PBS -q dirac25x 
#PBS -M james.bamber@physics.ox.ac.uk
#PBS -m p

### abe

# Modules
module load hdf5/intel_par/1.10.2
# Ignore any placement instructions from the job scheduler.
export I_MPI_JOB_RESPECT_PROCESS_PLACEMENT=0
# Each process and all of its OMP threads on the same socket.  
export I_MPI_PIN_DOMAIN=sock
# Change to job submission directory
cd $PBS_O_WORKDIR

# Set threads
export OMP_NUM_THREADS=2
# np processes in total, with perhost process on each of the nodes.

export location=/home/dc-bamb1/GRChombo/Examples/NewtonianScalar_equal_mass_complex/
export application=Main_ScalarField3d.Linux.64.mpiicpc.ifort.OPTHIGH.MPI.OPENMPCC.ex

mpirun -perhost 18 -np 180 ${location}${application} ../params.txt
